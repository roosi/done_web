<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>done</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.4.2.min.css">
    <script type="text/javascript" src="js/jquery-2.1.0.min.js"></script>
    <script type="text/javascript" src="js/jquery.mobile-1.4.2.min.js"></script>
    <script type='text/javascript' src='js/knockout-3.1.0.js'></script>
</head>
    
<body>

<div data-role="page" id="tasks">
    <div data-role="header">
        <h1>done</h1>
    </div><!-- /header -->

    <div data-role="content">
        <ul data-role="listview" data-bind="foreach: tasks">
            <li data-bind="click: $root.navigateToTask">
                <img class="status-image" src="http://placehold.it/100x100">
                <p class="status-date" data-bind="text: date"></p>
                <p class="task-name" data-bind="text: name"></p>
                <p class="task-notes" data-bind="text: notes"></p>
            </li>
        </ul>
    </div><!-- /content -->

    <div data-role="footer">
        <h4>powered by Google</h4>
    </div><!-- /footer -->

</div>

<div data-role="page" id="task" data-bind="with: selectedTask" data-add-back-btn="true">
    <div data-role="header">
        <a href="#" data-icon="back" data-rel="back">Back</a>
        <h1 data-bind="text: name"></h1>
    </div><!-- /header -->

    <div data-role="content">
        <img src="http://placehold.it/100x100">
        <p data-bind="text: name"></p>
        <p data-bind="text: date"></p>
        <p data-bind="text: notes"></p>

        <input data-bind="value: notes"></input>
        <textarea data-bind="text: notes"></textarea>
    </div>
</div>

</body>
    
<script>

function TaskListsViewModel() {
    // model
    var self = this;
    self.taskLists = ko.observableArray([
        { name: 'task list 1'}, { name: 'task list 2'}, { name: 'task list 3'}, { name: 'task list 4'}]);
    self.selectedTaskList = ko.observable();
    self.tasks = ko.observableArray();
    self.selectedTask = ko.observable();

    self.selectedTaskList.subscribe(function(newValue) {
        console.log("selectedTaskList:" + newValue.name);
        if (newValue != self.selectedTaskList)
        {
            self.navigateToTaskList(newValue);
        }
    });

    // behaviours
    self.navigateToTaskList = function(taskList) {
        console.log("navigateToTaskList:" + taskList.name);
        self.tasks([
            { name: "Task name 1", date:"09.03.2014", notes: "Pellentesque est sem, posuere vitae tincidunt non, cursus ac massa." },
            { name: "Task name 2", date:"11.03.2014", notes: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin lacus felis, porttitor ut tincidunt eget, mattis viverra risus." },
            { name: "Task name 3", date:"14.03.2014", notes: "" },
            { name: "Task name 4", date:"16.03.2014", notes: "" },
            { name: "Task name 5", date:"17.03.2014", notes: "" },
            { name: "Task name 6", date:"21.03.2014", notes: "" },
            { name: "Task name 7", date:"21.03.2014", notes: "" }
        ]);
        self.selectedTask(null);
    };

    self.navigateToTask = function(task) {
        console.log("navigateToTask:" + task.name);
        self.selectedTask(task);
        $.mobile.navigate( "#task" );
    };

    self.navigateToTaskList({ name: 'task list 1'});
};

ko.applyBindings(new TaskListsViewModel());
</script>
</html>
